<!DOCTYPE html>
<html lang="zh">
<%- include("./../public/head.ejs") %>
<body>
<%- include("./../public/header.ejs") %>
<%- include("./../public/banner.ejs") %>
<section class="main">
    <div class="container clearfix">
        <%- include("./../public/user/user-aside.ejs") %>
        <section class="main-right">
           
            <%- include("./../public/user/user-nav.ejs") %>

            <% if( book.length > 0) { %>
            <section class="main-right-borrow">
                <ul class="main-right-borrow-list clearfix">
                  <%if(book.length>12){var max=12;}else{var max=book.length;}%>
                    <% for(var i = 0; i < max; i++) {%>
                    <li class="main-right-borrow-list-item">
                        <div class="main-right-borrow-list-item-img">
                            <img src="/hopelibrary/<%= book[i].bookImgSrc %>" alt="">
                        </div>
                        <div class="main-right-borrow-list-item-message">
                            <h4> <%= book[i].bookName %> </h4>
                            <p>编号：<%= book[i].bookHopeID %> </p>
                            <% if(book[i].bookLeft <= 0) { %>
                            <button disabled="disabled">已借出</button>
                            <% } else {%>
                            <button data-borrowID=<%= book[i].bookID%> class="js-borrow-btn">借阅</button>
                            <% } %>
                        </div>
                    </li>
                    <% } %>
                </ul>
            </section>
            <% } else { %>
            <section class="main-right-table">
                <table>
                    <thead>
                    <th class="t-10 center">当前暂无图书</th>
                    </thead>
                </table>
            </section>
            <% } %>
        
            <%if(secondPath){%>
                <%if(bookNum>1){%>
                    <section class="main-right-page-num">
                    <%if(bookNum>10){
                        if(bookPage==1 || bookPage==bookNum){%>
                            <span 
                            <%if(bookPage==1){%>
                                class="main-right-page-num-active" 
                            <%}%>
                            ><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=1">1</a></span>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=2">2</a></span>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=3">3</a></span>
                            <span><a href="">...</a></span>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookNum-2%>"><%=bookNum-2%></a></span>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookNum-1%>"><%=bookNum-1%></a></span>
                            <span 
                            <%if(bookNum==bookPage){%>
                                class="main-right-page-num-active"
                            <%}%>
                            ><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookNum%>"><%=bookNum%></a></span>
                        <%}else{%>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=1">1</a></span>
                            <%if(bookPage>3){%>
                                <span><a href="">...</a></span>
                            <%}%>
                            <%if(bookPage>=3){%>
                                <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookPage-1%>"><%=parseInt(bookPage)-1%></a></span>
                            <%}%>
                            <span class="main-right-page-num-active"><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookPage%>"><%=bookPage%></a></span>
                            <%if(bookPage<(parseInt(bookNum)-1)){%>
                                <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=parseInt(bookPage)+1%>"><%=parseInt(bookPage)+1%></a></span>
                            <%}%>
                            <%if(bookPage<(parseInt(bookNum)-2)){%>
                                <span><a href="">...</a></span>
                            <%}%>
                            <span><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=bookNum%>"><%=bookNum%></a></span>
                        <%}
                    }else{%>
                        <%for(var k=1;k<=bookNum;k++){%>
                            <span 
                            <%if(k==bookPage){%>
                                class="main-right-page-num-active"
                            <%}%>
                            ><a href="/hopelibrary/book<%="/cate/"+secondPath%>?pageTab=<%=k%>"><%=k%></a></span>
                        <%}%>
                    <%}%>
                <%}else{%>
                    <table><th class="t-10 center">当前架上尚无图书</th></table>
                    </section>
                <%}%>
            <%}else{%>
                <%if(bookNum>1){%>
                    <section class="main-right-page-num">
                    <%if(bookNum>10){
                        if(bookPage==1 || bookPage==bookNum){%>
                            <span 
                            <%if(bookPage==1){%>
                                class="main-right-page-num-active" 
                            <%}%>
                            ><a href="/hopelibrary/book?pageTab=1">1</a></span>
                            <span><a href="/hopelibrary/book?pageTab=2">2</a></span>
                            <span><a href="/hopelibrary/book?pageTab=3">3</a></span>
                            <span><a href="">...</a></span>
                            <span><a href="/hopelibrary/book?pageTab=<%=bookNum-2%>"><%=bookNum-2%></a></span>
                            <span><a href="/hopelibrary/book?pageTab=<%=bookNum-1%>"><%=bookNum-1%></a></span>
                            <span 
                            <%if(bookNum==bookPage){%>
                                class="main-right-page-num-active"
                            <%}%>
                            ><a href="/hopelibrary/book?pageTab=<%=bookNum%>"><%=bookNum%></a></span>
                        <%}else{%>
                            <span><a href="/hopelibrary/book?pageTab=1">1</a></span>
                            <%if(bookPage>3){%>
                                <span><a href="">...</a></span>
                            <%}%>
                            <%if(bookPage>=3){%>
                                <span><a href="/hopelibrary/book?pageTab=<%=bookPage-1%>"><%=parseInt(bookPage)-1%></a></span>
                            <%}%>
                            <span class="main-right-page-num-active"><a href="/hopelibrary/book?pageTab=<%=bookPage%>"><%=bookPage%></a></span>
                            <%if(bookPage<(parseInt(bookNum)-1)){%>
                                <span><a href="/hopelibrary/book?pageTab=<%=parseInt(bookPage)+1%>"><%=parseInt(bookPage)+1%></a></span>
                            <%}%>
                            <%if(bookPage<(parseInt(bookNum)-2)){%>
                                <span><a href="">...</a></span>
                            <%}%>
                            <span><a href="/hopelibrary/book?pageTab=<%=bookNum%>"><%=bookNum%></a></span>
                        <%}%>
                    <%}else{%>
                        <%for(var k=1;k<=bookNum;k++){%>
                            <span 
                            <%if(k==bookPage){%>
                                class="main-right-page-num-active"
                            <%}%>
                            ><a href="/hopelibrary/book?pageTab=<%=k%>"><%=k%></a></span>
                        <%}%>
                    <%}%>
                <%}else{%>
                    <table><th class="t-10 center">当前架上尚无图书</th></table>
                    </section>
                <%}%>
            <%}%>
          
            
        </section>
    </div>
</section>
<%- include("./../public/footer.ejs") %>
<script src="/hopelibrary/js/public/require.js" type="text/javascript" charset="utf-8"></script>
<script>
  requirejs.config({
    baseUrl: "/hopelibrary/js",
    paths:{
      hajax: "public/hajax",
      jquery: "public/jquery",
      hlayer: "./hlayer/hlayer",
      bookcate: "./user/bookcate"
    },
    shim: {
      hajax: {exports: "hajax"},
      hlayer: {exports: "hlayer"},
      bookcate: {exports: "bookcate"}
    }
  })
  requirejs(["jquery", 'hlayer', 'bookcate'],function($, hlayer,bookcate) {
    bookcate.borrow("book");
    // bookcate.scroll();
  })

  $('#searchInput').keyup(function(e){
        if(e.keyCode==13){
            if($('#searchInput').val()){
                window.location.replace("http://202.116.83.77/hopelibrary/book/search?word="+$('#searchInput').val());
            }
        }
  });

  $('#searchBox').click(function(e){
    if($('#searchInput').val()){
        window.location.replace("http://202.116.83.77/hopelibrary/book/search?word="+$('#searchInput').val());
    }
  })
</script>
</body>
</html>